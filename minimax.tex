% !TEX root = scombinatorics.tex
\documentclass[scombinatorics.tex]{subfiles}
\begin{document}
\chapter{Three minimax theorems}
\label{minimax}

\def\medrel#1{\parbox[t]{6ex}{$\displaystyle\hfil #1$}}
\def\ceq#1#2#3{\parbox[t]{30ex}{$\displaystyle #1$}\medrel{#2}{$\displaystyle #3$}}

\def\separatore{\hfil o \rule[0.5ex]{4ex}{0.1ex} o \rule[0.5ex]{4ex}{0.1ex} o}

Though apparently unrelated, the three theorems in this chapter can be derived one each other.
We prove them in an arbitrary order.

As evident from the statement, the last two theorems are minimax theorems.
The first theorem less so, hence the title is only approximately correct.

%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%
\section{Hall's Marriage Theorem}\label{marriage}

\def\ceq#1#2#3{\parbox[t]{30ex}{$\displaystyle #1$}\medrel{#2}{$\displaystyle #3$}}

Let $\phi(x\,;z)$ be given. 
Let $A\subseteq\U$ and $B\subseteq\V$ be finite sets.

We say that $A'\subseteq A$ is a \emph{set of distinct representatives\/} for $\phi(A\,;B)$ if there is a bijection $h:A'\to B$ such that $\phi(a;ha)$ for all $a\in A'$.

\begin{void_thm}[Hall's Marriage Theorem]\label{thm_marriage}
  For every finite $B\subseteq\V$, the following are equivalent
  \begin{itemize}
    \item[1.] $\phi(A\,;B)$ has a set of distinct representatives;

    \item[2.] $\displaystyle|B'|\ \le\ \bigg|\bigcup_{b\in B'}\phi(A\,;b)\bigg|$ for every $B'\subseteq B$.
  \end{itemize}
\end{void_thm}

\begin{proof}
  \textbf{\boldmath(\ssf{1}$\IMP$\ssf{2})}
  The following holds for any set of distinct representatives $A'$ and every set $B'\subseteq B$  

  \ceq{\hfill|B'|\medrel{=}\bigg|\bigcup_{b\in B'}\phi(A';b)\bigg|}
  {\subseteq}
  {\bigg|\bigcup_{b\in B'}\phi(A\,;b)\bigg|.}

  \textbf{\boldmath(\ssf{2}$\IMP$\ssf{1})}
  Reason by induction on the cardinality of $B$.
  If $|B|=1$, the claim is clear.
  Now assume $|B|>1$ and consider two cases.

  \begin{itemize}
    \item[a.]
    This is the case when the inequality in \ssf{2} is strict for all nonempty $B'\subset B$. 
    Pick any pair $a,b\in A,B$ such that $\phi(a\,;b)$. 
    Then $\phi(A\sm\{a\}\,; B\sm\{b\})$ still satisfy \ssf{2}.
    By induction hypothesis, it has a set of distinct representatives $A'$.
    Then $A'\cup\{a\}$ is a set of distinct representatives for $\phi(A\,;B)$ as we can extend any bijection $h:A'\to B\sm\{b\}$ by mapping $a$ to $b$. 

    
    \item[b.]
    Suppose instead that for some nonempty $B'\subset B$ the inequality in \ssf{2} holds with equality.
    Define

    \ceq{\hfill A'}
    {=}
    {\bigcup_{b\in B'}\phi(A\,;b)}
    
    It is clear that \ssf{2} holds for $\phi(A';B')$.
    Below we prove that \ssf{2} also holds for $\phi(A{\sm} A'\,;\,{B\sm} B')$.
    Once this claim is proved, we apply the induction hypothesis to obtain sets of distinct representatives for these two relations and note that their union is a set of distinct representatives for $\phi(A\,;B)$.

    To prove the claim assume that there is a set $B''\,\subseteq\ B\sm B'$ that contradicts \ssf{2}, then

    \ceq{\hfill\bigg|\bigcup_{b\in B''}\phi(A{\sm} A'\,;\,b)\bigg|}
    {<}
    {|B''|.}

    By the definition of $A',B'$

    \ceq{\hfill \bigcup_{b\in B'\cup B''}\phi(A\,;b)}
    {=}
    {\bigcup_{b\in B'}\phi(A\,;b)\ \ \cup\ \ \bigcup_{b\in B''}\phi(A\,;b)}

    \ceq{}
    {=}
    {\phantom{\bigcup_{b\in B'}\phi(A\,;b)}\llap{$A'$\kern4ex}\ \ \cup\ \ \bigcup_{b\in B''}\phi(A\,;b)}

    \ceq{}
    {=}
    {\phantom{\bigcup_{b\in B'}\phi(A\,;b)}\llap{$A'$\kern4ex}\ \ \cup\ \ \bigcup_{b\in B''}\phi(A{\sm} A'\,;b)}

    The two sets above are disjunct, hence 

    \ceq{\hfill\bigg|\bigcup_{b\in B'\cup B''}\phi(A\,;b)\bigg|}
    {>}
    {|A'|+|B''|}

    As $|A'|=|B'|$, by the choice of $A',B'$, we obtain that $B'\cup B''$ contradicts the inequality in \ssf{2}.
    This prove the claim and with it the theorem.
  \end{itemize}\vspace*{-4ex}
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%
\section{K\H{o}nig's Minimax Theorem}\label{Konig}

Let $\phi(x\,;z)$ be given. 
Let $A\subseteq\U$ and $B\subseteq\V$ be finite sets. 

A \emph{matching\/} of $\phi(A\,;B)$ is a pair of sets $A'\subseteq A$  and $B'\subseteq B$ such that there is a bijection $h:A'\to B'$ such that $\phi(a\,;ha)$ for all $a\in A'$.
We call $|A'|=|B'|=|h|$ the cardinality of the matching.
The \emph{matching number} of $\phi(A\,;B)$ is the maximal cardinality of a matching.

Note that if $\phi(A\,;B)$ admits a set $A'$ of distinct representatives then $A',B$ is a matching and, as this clearly maximal, the matching number of $\phi(A\,;B)$ is $|B|$.

A \emph{(vertex) cover\/} of $\phi(A\,;B)$ is a pair of sets $A'\subseteq A$ and $B'\subseteq B$ such that 

\ceq{\hfill \phi(A\,;B)}{\subseteq}{\big(A'\times B\big)\,\cup\, \big(A\times B'\big)}

or, in other words,

\ceq{\hfill\phi(a,b)}{\IMP}{a\in A'\ \vee\ b\in B'}\hfill for every $a\in A$ and $b\in B$.

We will mainly use this property as characterized by the easy fact below.

\begin{fact}\label{fact_cover}
   The following are equivalent
   \begin{itemize}
      \item[1.] $A',B'$ is a cover;
      \item[2.] $\phi(A\,;b)\subseteq A'$ for every $b\in B\sm B'$;
      \item[3.] $\phi(a\,;B)\subseteq B'$ for every $a\in A\sm A'$.\QED
   \end{itemize}
\end{fact}

We call $|A'|+|B'|$ the cardinality of the cover.
The \emph{cover number\/} of $\phi(A\,;B)$ is the minimal cardinality of a cover.


\begin{void_thm}[K\H{o}nig's Minimax Theorem]
   For any given  $\phi(A\,;B)$, matching number $=$ cover number.
   That is, the maximal cardinality of a matching equals the minimal cardinality of a cover.
\end{void_thm}

\begin{proof}
  {\boldmath$(\le)$}
  Note that if $A'\subseteq A$ and $B'\subseteq B$ then every cover of $\phi(A,B)$ contains a cover of $\phi(A',B')$.
  Therefore the coverer number of $\phi(A',B')$ is less or equal than the cover number of $\phi(A,B)$.
  If $h:A'\to B'$ is a bijection, any cover has to contain either $a$ or $ha$ for all $a\in A$.
  Hence the cover number is at least as large as the maching number.

  {\boldmath$(\ge)$}
  Let $A',B'$ be a cover of minimal cardinality. 
  We prove that there is a matching of cardinality at least $|A'|+|B'|$.

  We break $\phi(A\,;B)$ into two relations, find a matching of each of these and join them together to obtain a matching of cardinality $\ge|A'|+|B'|$.
  Precisely, first we show that $\phi(A{\sm} A'\,;B')$ has a set of distinct representatives $A_1\subseteq A\sm A'$.
  Hence $A_1,B'$ is a matching.
  Second, we apply the same argument shows that $\phi(A'\,;B{\sm} B')^{\rm op}$ has a  set of distinct representatives $B_2\subseteq B\sm B'$.
  Hence $A',B_1$ is a matching.
  Then $(A_1\cup A'),\ (B'\cup B_1)$ is a matching of  $\phi(A\,;B)$.
  The cardinality of this matching is $|A_1|+|A'|=|B_1|+|A'|=|B'|+|A'|$.
  
  We use Hall's Marriage Theorem to prove the first claim above.
  The second is proved by the symmetric argument (using \ssf{3} of the fact above in place of \ssf{2}). 

  We need to check that $\phi(A{\sm} A'\,;B')$ satisfies \ssf{2} of Theorem~\ref{thm_marriage}.
  Suppose not. Then there is a set $B''\subseteq B'$ such that $|A''|<|B''|$, where

  \ceq{\hfill A''}{=}{\bigcup_{b\in B''}\phi(A{\sm} A',b)}

  Then $(A'\cup A''), (B'\sm B'')$ would be a cover of cardinality $<|A'|+|B'|$.
  This contradicts the minimality of $A',B'$.
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%\clearpage
\section{Dilworth's Theorem}\label{shadow}

Dilworth's Theorem is minimax theorem essentially equivalent to K\H{o}nig's Theorem.
To highlight the connection we choose to prove it using K\H{o}nig's Theorem. 
Alternatively we could have proved Dilworth's Theorem directly and derived K\H{o}nig's and Hall's Theorem from it.

Let $<$ be a strict partial order on $\U$.
An \emph{antichain\/} is a set $A'\subseteq\U$ such that $a\nless a'$ for every $a,a'\in A'$. A \emph{chain\/} is a set $A'\subseteq\U$ such that $a<a'\;\vee\ a'<a$ for every distinct $a,a'\in A'$.

\begin{void_thm}[Dilworth's Theorem]
  Let $A\subseteq\U$ be finite. 
  The maximal cardinality of an antichain $A'\subseteq A$ equals the minimal cardinality of a partition of $A$ into chains. 
\end{void_thm}

\begin{proof}
  {\boldmath$(\le)$}
  We prove that the cardinality of an antichain cannot exceed the cardinality of a partition of $A$ into chains.

  Let $A_1,\dots,A_k$ be a partition of $A$ into chains and let $A'$ be an antichain.
  A chain can contain at most one element of $A'$, hence $|A'|\le k$.

  {\boldmath$(\ge)$}  
  Let $A'\subseteq A$ be an antichain of maximal cardinality.
  We prove that there is a partition $A_1,\dots,A_k$ into chains for some $k\le|A'|$.

  %(for uniformity with the notation in K\H{o}nig's Theorem, here we denote by $A'$ the complement of the chain). 

  Let $\V$ be a disjoint copy of $\U$.
  Let $f:\U\to\V$ the bijection that maps each element of $\U$ to its copy in $\V$.
  For $a,b\in\U$ such that $a<b$ let $\phi(a\,;fb)$.
  Let $A_1,B_1$ be a cover of $\phi\big(A\,;f[A]\big)$.
  We claim that $A \sm \big(A_1\cup f^{-1}[B_1]\big)$ is an antichain.
  In fact, if $a<b$ then either $a\in A_1$ or $fb\in B_1$, by the definition of cover.
  This proves the claim.

  As $A'$ has maximal cardinality, $|A| - |A'|\le |A_1\cup f^{-1}[B_1]|\le |A_1\cup B_1|$.
  If we choose a over $A_1,B_1$ of minimal cardinality, by K\H{o}nig's Theorem there is a matching $h:A''to B''$ of cardinality $|A''|\ge |A_1\cup B_1|$. Hence $|A''|\ge |A\sm A'|$.

  We construct a chain-partition of $A$ as follow.
  Pick an element of $a_0\in A''$ and construct the longest possible chain $a_0,ha_0,a_1,ha_1,\dots,a_m,hb_m,a_{m+1}$ where $a_i\in A''$ for all $i\le m$ and $a_{i+1}\in A$ is the copy of $b_i\in B''$.
  The construction halts at the first $a_{m+1}\not\in A''$.
  Then we start a new chain from some fresh element of $A''$ until the chains $a_0<a_1<\dots<a_m<a_{m+1}$ constructed in this way cover the whole of $A''$.
  Note that these chains are pairwise disjoint.
  Finally, put each element of $A$ not covered by these chains in a chain on its own.
  
  Notice that the elements of $A''$ belongs to a chain of length at least 2.
  Therefore the number $k$ of chains necessary to cover $A$ is $\le |A|\sm |A''| \le  |A'|$.
\end{proof}

\end{document}
\begin{comment}
%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%
\section{Shadows}\label{shadow}
\def\ceq#1#2#3{\parbox[t]{29ex}{$\displaystyle #1$}
\medrel{#2}
{$\displaystyle #3$}}

Define the formula

\ceq{\hfill\partial\phi(x\;;\,y,z)}
{=}
{\phi(x\;;\,z)\wedge x{\neq} y.}

It is called the shadow of $\phi(x\;;\,z$).
It defines a relation between $\U$ and $\U\times\V$.  
Note that

\ceq{\hfill\partial\phi(x\;;\,y,z)_{a,b\in\U,\V}}
{=}
{\Big\{\phi(A\;;\,b)\sm\{a\}\ :\ a,b\in\U,\V\Big\}.}

The following is sometimes called the local LYM inequality.

\begin{lemma}

   For any $1\le k\le n$

   % \ceq{\hfill\bigg|{A\choose k}\cap\phi(A\;;\,b)_{b\in\V}\bigg|\cdot{n\choose k}^{\kern-.8ex-1}{\kern-1.5ex}}
   % {\le}
   % {\bigg|{A\choose k-1}\cap\partial\phi(A\;;\,a,b)_{a,b\in\U,\V}\bigg|\cdot{n\choose k-1}^{\kern-.8ex-1}{\kern-.8ex}}

   % \ceq{\hfill\bigg|{A\choose k}\cap\phi(A\;;\,b)_{b\in\V}\bigg|\cdot{n\choose k}^{\kern-.8ex-1}{\kern-.8ex}}
   % {\le}
   % {\bigg|{A\choose k-1}\cap\phi(A\sm\{a\}\;;\,b)_{a,b\in\U,\V}\bigg|\cdot{n\choose k-1}^{\kern-.8ex-1}{\kern-.8ex}}

   \ceq{\hfill\Pr{}_k\Big(\phi(A\;;\,b)_{b\in\V}\Big)}
   {\le}
   {\Pr{}_{k-1}\Big(\partial\phi(A\;;\,a,b)_{a,b\in\U,\V}\Big)}


\end{lemma}

\begin{proof}
   Consider the bipartite graph between $A^{(k)}$ and $A^{(k-1)}$ that has an edge between all sets $\phi(A\;;\,b)\in A^{(k)}$ and their respective subsets in $A^{(k-1)}$.
   That is $\phi(A\;;\,b){\sm}\{a\}$ where $a$ is any of the $k$ elements of $\phi(A\;;\,b)$.
   The number of edges of this graph is

   \ceq{\hfill\bigg|{A\choose k}\cap\phi(A\;;\,b)_{b\in\V}\bigg|\cdot k}{}{}

   Each set $\phi(A\;;\,b){\sm}\{a\}\in A^{(k-1)}$ is a node of degree at most $n-k+1$.
   Hence the number of edges of this graph is

   \ceq{}{\le}{\bigg|{A\choose k-1}\cap\partial\phi(A\;;\,a,b)_{a,b\in\U,\V}\bigg|\cdot(n-k+1)}

   To obtained the required inequality it suffice to note that


   \ceq{\hfill{n\choose k}^{\kern-.8ex-1}{\kern-.8ex}\cdot (n-k+1)}{=}{{n\choose k-1}^{\kern-.8ex-1}{\kern-.8ex}\cdot k}

   % \ceq{\hfill\bigg|{A\choose k}\cap\phi(A\;;\,b)_{b\in\V}\bigg|\cdot{n\choose k}^{\kern-.8ex-1}{\kern-.8ex}}
   % {\le}
   % {\bigg|{A\choose k-1}\cap\partial\phi(A\;;\,a,b)_{a,b\in\U,\V}\bigg|\cdot{n\choose k-1}^{\kern-.8ex-1}{\kern-.8ex}}

   % \ceq{\hfill{A\choose k-1}\cap\partial\phi(A\;;\,a,b)_{a,b\in\U,\V}}
   % {\subseteq}
   % {\bigg({A\choose k}\cup{A\choose k-1}\bigg)\cap\phi(A\;;\,b)_{b\in\V}}

   \vskip-3ex
\end{proof}

is the formula that define a relation between $\U$ and $\U\times\V$

\ceq{\hfill\partial^k\phi(x\;;\,z\,y_1\dots y_k)}{=}{\phi(x\;;\,z)\wedge \bigwedge^k_{i=1} x{\neq} y_i.}


\ceq{\hfill\partial^k\phi(A\;;\,b\,a_1\dots a_k)_{b,a_1\dots a_k\in\V\times\U^k}}{=}{\bigcup_{a_1\dots a_k\in A^k}\phi(A\sm\{a_1\dots a_k\}\;;\,b)_{b\in\V}.}

\ceq{\hfill\partial^k\phi(A\;;\,b\,a_1\dots a_k)_{b,a_1\dots a_k\in\V\times\U^k}}{=}{
\Big\{\phi(A\sm\{a_1\dots a_k\}\;;\,b)\: :\ a_1,\dots,a_k\in\U, b\in\V \Big\}.}

$\big(\partial^k\phi(x\;;\,z\,y_1\dots y_k)\big)_{b,a_1\dots a_k\in\V\times\U^k,\, n-k}$

$\phi(A\;;\,b)_{b\in\V,\, k}$

\end{comment}