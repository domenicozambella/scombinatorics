% !TEX root = scombinatorics.tex
\documentclass[scombinatorics.tex]{subfiles}
\begin{document}
\chapter{Set systems}
\label{SetSystems}



\def\medrel#1{\parbox[t]{6ex}{$\displaystyle\hfil #1$}}
\def\ceq#1#2#3{\parbox[t]{40ex}{$\displaystyle #1$}\medrel{#2}{$\displaystyle #3$}}

\def\separatore{\hfil o \rule[0.5ex]{4ex}{0.1ex} o \rule[0.5ex]{4ex}{0.1ex} o}


%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%
\section{Sperner's Theorem}\label{sperner}

We say that $\phi(A\,;b)_{b\in\V}$ is an \emph{antichain\/} if there is no pair of distinct elements $b,b'\in\V$ such that $\phi(A\,;b)\subset\phi(A\,;b')$.
Antichains are also called \emph{Sperner systems.}

If all sets in $\phi(A\,;b)_{b\in\V}$ are distinct and of equal cardinality, then we clearly have an antichain.
If $|A|=n$, the cardinality of a collection of subsets of $A$, all of cardinality $k$, is maximal when $k=\lfloor n/2\rfloor$ or $k=\lceil n/2\rceil$.
In this case\smallskip

\ceq{\hfill\big|\phi(A\,;b)_{b\in\V}\big|}
{=}
{{n\choose\lfloor n/2\rfloor}}

\ceq{}
{=}
{{n\choose\lceil n/2\rceil}.}\smallskip

By the following classical theorem, this bound holds for all antichain.
This is one of the first results of external combinatorics (though the term has been coined a few years later).

\def\ceq#1#2#3{\parbox[t]{36ex}{$\displaystyle #1$}\medrel{#2}{$\displaystyle #3$}}

\begin{void_thm}[Sperner's Theorem]
  Let $A\subseteq\U$ have cardinality $n$, finite.
  If $\phi(A\,;b)_{b\in\V}$ is an antichain then
  
  \ceq{\hfill\big|\phi(A\,;b)_{b\in\V}\big|}
  {\le}
  {{n\choose\lfloor n/2\rfloor}.}
\end{void_thm}
\smallskip
\begin{proof}
   Clearly, $\phi(A\,;b)_{b\in\V}$ is the disjoint union of the sets \smash{$\displaystyle{A\choose k}\cap\phi(A\,;b)_{b\in\V}$} for $k$ ranging over $\{0,\dots,n\}$.
   Then 

   \ceq{\hfill\big|\phi(A\,;b)_{b\in\V}\big|}
   {=}
   {\sum^n_{k=0}\bigg|{A\choose k}\cap\phi(A\,;b)_{b\in\V}\bigg|.}

   As for every $k\le n$
   
   \ceq{\hfill{n\choose k}}{\le}{{n\choose\lfloor n/2\rfloor},}

   the theorem follows immediately from the LYM inequality that we prove below.
\end{proof}

The acronym LYM stands for Lubell-Yamamoto-Meshalkin.

\begin{lemma}[(LYM inequality)]
   Let $A\subseteq\U$ have cardinality $n$, finite.
   If $\phi(A\,;b)_{b\in\V}$ is an antichain then
   
   % \ceq{\hfill\sum^n_{k=0}\frac{\big|\phi(A\,;b)_{b\in\V}\ \cap\  A^{(k)}\big|}{\big|A^{(k)}\big|}}{\le}{1.}

   \ceq{\hfill\sum^n_{k=0}\bigg|{A\choose k}\cap\phi(A\,;b)_{b\in\V}\bigg|\cdot{n\choose k}^{\kern-.8ex -1}\kern-.8ex}{\le}{1.}
\end{lemma}
\smallskip
\begin{proof}
   Let $\Pi$ be uniform random variable that ranges over the set of permutations of $A=\{a_1,\dots,a_n\}$.
   For any $\phi(A\,;b)$ of cardinality $k$
   
   \ceq{\hfill\Pr\bigg(\Pi\{a_1,\dots,a_k\}=\phi(A\,;b)\bigg)\kern-.8ex}{=}{ {n\choose k}^{\kern-.8ex -1}\kern-1.5ex.}

   The events above are disjoint for distinct sets $\phi(A\,;b)$, hence 

   \ceq{\hfill\Pr\bigg(\Pi\{a_1,\dots,a_k\}\in\phi(A\,;b)_{b\in\V} \bigg)\kern-.8ex}{=}{\bigg|{A\choose k}\cap\phi(A\,;b)_{b\in\V}\bigg|\cdot{n\choose k}^{\kern-.8ex -1}\kern-1.5ex. }

   As $\phi(A\,;b)_{b\in\V}$ is an antichain, for distinct $k$ the events above are disjoint, hence

   \ceq{\hfill\Pr\bigg(\bigcup^n_{k=0}\Pi\{a_1,\dots,a_k\}\in\phi(A\,;b)_{b\in\V} \bigg)\kern-.8ex}{=}{\sum^n_{k=0}\bigg|{A\choose k}\cap\phi(A\,;b)_{b\in\V}\bigg|\cdot{n\choose k}^{\kern-.8ex-1}\kern-1.5ex. }

   Now, the inequality is evident.
\end{proof}

Let $\Pr_k$ be the probability measure on the subsets of $A$ that is concentrated and uniform on $A^{(k)}$.
Namely, for $A'\subseteq A$

\ceq{\hfill{\Pr}_k\big(\{A'\}\big)}
{=}
{\left\{
\begin{array}{ll}
   \kern1.5ex0&\textrm{if}\kern1.5ex |A'|\neq k\\
   \displaystyle{n\choose k}^{\kern-.8ex-1} &\textrm{if}\kern1.5ex |A'|= k\\
\end{array}\right.}

Then the the LYM inequality asserts that if $\phi(A\,;b)_{b\in\V}$ is an antichain then


\ceq{\hfill\sum^n_{k=0}{\Pr}_k\big(\phi(A\,;b)_{b\in\V}\big)}{\le}{1.}

This inequality is strict when $\phi(A\,;b)_{b\in\V}=A^{(k)}$ for some $k$. 
In the next section we show that these are the only cases.



%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%
\section{Intersecting families}\label{ErdosKoRado}

A family of sets is \emph{intersecting\/} if any two of its elements have non empty intersection.

\def\medrel#1{\parbox[t]{4ex}{$\displaystyle\hfil #1$}}
\def\ceq#1#2#3{\parbox[t]{20ex}{$\displaystyle #1$}\medrel{#2}{$\displaystyle #3$}}

\begin{lemma}[(Peter J.~Cameron)]
   Let $G$ be a $1$-transitive finite graph.
   If $G$ contains a clique of cardinality $m$, then every subgraph $H\subseteq G$ contains a clique of cardinality $k$ where 
   
   \ceq{\hfill k}{\ge}{m\frac{|H|}{|G|}.}
\end{lemma}

\begin{proof}
   Let $p=|\Aut(G)|$.
   For any fixed $a\in G$ and $b$ ranging over $G$, the sets $F_{a,b}=\{f\in\Aut(G): fa=b\}$, are clearly mutually disjoint.
   We claim that they all have the same cardinality. 
   In fact, by $1$-transitivity, if $gb=b'$ then  $F_{a,b'}=g^{-1}F_{a,b}$.
   Hence, for any given pair $\<a,b\>$, they have cardinality $p/|G|$.

   Let $C$ be a clique in $G$ of cardinality $m$.
   Let $k$ the cardinality of the largest clique in $H$.
   Count the elements of the following set
   
   \hfil$\Big\{\<a,f\>\in C\times\Aut(G)\ \ :\ \ fa\in H\Big\}$.

   By the above, for every $a\in C$ there are $p\cdot|H|/|G|$ automorphisms that map $a$ in $H$.
   So the number of pairs in the set above is $m\cdot p\cdot|H|/|G|$.

   Now we count the same set in a different way.
   Note that $f[C]\cap H$ is a clicque of $H$, hence has cardinality $\le k$.
   Therefore, for a given $f$ there at most $k$ choices of $a\in C$.
   So $m\cdot p\cdot|H|/|G|\le k\,p$.
\end{proof}

We use the lemma above to bound the size $m$ of the maximal clicque in a graph $G$.
We isolate an subgraph $H\subseteq G$ of which we can easily calculate the size $k$ of the maximal clicque.
Then by the lemma 

\ceq{\hfill m}{\le}{\frac{k}{|H|}|G|.}

\begin{void_thm}[Erd\H{o}s-Ko-Rado Theorem]
   Let $A\subseteq\U$ be a finite set of cardinality $n$. 
   Let $k\le n/2$.
   Let $\phi(A\,;b)_{b\in\V}$ be an intersecting family of sets of cardinality $k$.
   Then 
   
   \ceq{\hfill\Big|\phi(A\,;b)_{b\in\V}\Big|}{\le}{{n-1\choose k-1}.}
\end{void_thm}
   
\begin{proof}
   Let $m=\Big|\phi(A\,;b)_{b\in\V}\Big|$.
   Consider the graph with verteces
   
   \ceq{\hfill G}{=}{{A\choose k},}

   Thne edgese of $G$ are   

   \ceq{}{}{\Big\{\{A',A''\}\ :\  A'\cap A''\neq\0\Big\}.}

   Enumerate the elements of $A$, say $A=\{a_0,\dots,a_{n-1}\}$.
   Consider the following subgraph of $G$ 
   
   \ceq{\hfill H}{=}{\Big\{\{a_i,\dots,a_{i+k-1}\}\ :\  0\le i<n\Big\},}

   where the indices are intended modulo $n$.
   The largest clique in $H$ has cardinality $k$.
   This uses that $k\le n/2$.
   As $\phi(A\,;b)_{b\in\V}$ is an intersection family, it is a clique of $G$.
   
   By the lemma above (and the remark after it)

   \ceq{\hfill\Big|\phi(A\,;b)_{b\in\V}\Big|}{\le}{{\frac{k}{n}{n\choose k}}}

   and finally, by algebra,
  
   \ceq{}{=}{{{n-1}\choose {k-1}}.}
\end{proof}
\end{document}
